---
title: "Predicting attitudes towards racist college professors"
author: "Ojaswi Malik"
date: "`r lubridate::today()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rcfss)
library(modelr)
library(broom)
theme_set(theme_minimal())
```

```{r data}
#loading the data
gss_data <- rcfss::gss_colrac

#convert colrac to binary
gss_data <- gss_data %>%
  mutate(colrac = as.numeric(colrac))

```

## Using Age to make prediction

In this analysis I will estimate a logistic regression model of whether or not an individual believes the person should be allowed to teach with 'age' as the predictor. I will estimate predicted probabilities and plot the logistic regression line using ggplot.

```{r}
#estimating the model
age_model <- glm(colrac ~ age, data = gss_data,
                family = binomial)
tidy(age_model)

#estimating the predicted probabilities
age_data <- augment(age_model,
                     newdata = data_grid(gss_data, age),
                     type.predict = "response")

#graphing the line
ggplot(age_data, aes(age, .fitted)) +
  geom_line() +
  labs(title = "Relationship between age and attitudes towards racist college professors",
       y = "Predicted Probability of allowing racist prof. to teach",
       x = "Age") +
  scale_y_continuous(limits = c(0, 1))

```

**Observation**: From the above graph, we can observe that there is a negative correlation between age and attitude towards allowing racist professors to teach. This means that older individuals believe there is less probability for racist professors to teach. However, the significance of this correlation is quite low.

## Predicting the accuracy of the above model

```{r error rate}

age_model_accuracy <- augment(age_model, type.predict = "response") %>%
  mutate(.pred = as.numeric(.fitted > .5))
    
(age_model_err <- mean(age_model_accuracy$colrac != age_model_accuracy$.pred,
                      na.rm = TRUE))

```

**Observation**: The above model which predicts attitudes towards racist professors has an error rate of 49.3%. This is a very high error rate and hence we need to construct other models.

## Session info

```{r}
devtools::session_info()
```
